{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@ionic-native/geolocation/ngx\";\nimport * as i2 from \"../services/restaurant.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@ionic/angular\";\nconst _c0 = (a0, a1) => ({\n  \"open\": a0,\n  \"closed\": a1\n});\nfunction HomePage_ion_card_17_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"img\", 20);\n    i0.ɵɵelementStart(2, \"ion-badge\", 21);\n    i0.ɵɵelement(3, \"img\", 22);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const restaurant_r1 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"src\", restaurant_r1.images[0].base64, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", restaurant_r1.storeInfo.rate, \" \");\n  }\n}\nfunction HomePage_ion_card_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-card\")(1, \"div\", 12);\n    i0.ɵɵtemplate(2, HomePage_ion_card_17_ng_container_2_Template, 5, 2, \"ng-container\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ion-card-content\")(4, \"ion-card-title\", 14)(5, \"b\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"p\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 15)(10, \"div\", 16);\n    i0.ɵɵelement(11, \"span\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"div\", 16);\n    i0.ɵɵelement(13, \"ion-icon\", 17);\n    i0.ɵɵelementStart(14, \"span\");\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(16, \"div\", 16);\n    i0.ɵɵelement(17, \"ion-icon\", 18);\n    i0.ɵɵelementStart(18, \"span\")(19, \"b\");\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(21, \"div\", 16)(22, \"span\", 19);\n    i0.ɵɵtext(23);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(24);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const restaurant_r1 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", restaurant_r1.images[0] == null ? null : restaurant_r1.images[0].base64);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(restaurant_r1.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(restaurant_r1.text);\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate1(\"Min. Sipari\\u015F Tutar\\u0131: \\u20BA\", restaurant_r1.storeInfo.minOrderPrice, \"\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\"\", restaurant_r1.distance, \" km yak\\u0131n\\u0131nda\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(9, _c0, restaurant_r1.storeInfo.status === \"open\", restaurant_r1.storeInfo.status === \"closed\"));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", restaurant_r1.storeInfo.status === \"open\" ? \"\\u0130\\u015Fletme A\\u00E7\\u0131k\" : \"\\u0130\\u015Fletme Kapal\\u0131\", \" \");\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\" \", restaurant_r1.storeInfo.workingHours[0].open, \" / \", restaurant_r1.storeInfo.workingHours[0].close, \" \");\n  }\n}\nexport let HomePage = /*#__PURE__*/(() => {\n  var _HomePage;\n  class HomePage {\n    constructor(geolocation, restaurantService) {\n      this.geolocation = geolocation;\n      this.restaurantService = restaurantService;\n      this.restaurants = [];\n      this.allRestaurants = [];\n      this.limit = 10;\n      this.skip = 0;\n      this.latitude = 0;\n      this.longitude = 0;\n    }\n    ngOnInit() {\n      this.geolocation.getCurrentPosition().then(resp => {\n        this.latitude = resp.coords.latitude;\n        this.longitude = resp.coords.longitude;\n        this.loadRestaurants();\n      }).catch(error => {\n        console.log('Error getting location', error);\n      });\n    }\n    loadRestaurants(event) {\n      if (this.latitude !== undefined && this.longitude !== undefined) {\n        this.restaurantService.getRestaurants(this.latitude, this.longitude, this.limit, this.skip).subscribe(data => {\n          this.restaurants = this.restaurants.concat(data.response);\n          this.restaurants.forEach(restaurant => {\n            restaurant.distance = this.calculateDistanceInKilometers(this.latitude, this.longitude, restaurant.storeInfo.geoLocation.latitude, restaurant.storeInfo.geoLocation.longitude);\n          });\n          this.allRestaurants = this.restaurants;\n          if (event) {\n            event.target.complete();\n          }\n          this.skip += this.limit;\n        });\n      }\n    }\n    loadMore(event) {\n      this.loadRestaurants(event);\n    }\n    filterRestaurants(event) {\n      const searchTerm = event.target.value.toLowerCase();\n      if (searchTerm) {\n        this.restaurants = this.allRestaurants.filter(restaurant => {\n          return restaurant.title.toLowerCase().includes(searchTerm) || restaurant.text.toLowerCase().includes(searchTerm);\n        });\n      } else {\n        this.restaurants = this.allRestaurants;\n      }\n    }\n    calculateDistanceInKilometers(lat1, long1, lat2, long2) {\n      let EARTH_RADIUS_KM = 6371; // Dünya'nın kilometre olarak yarıçapı\n      let distance = Math.sqrt(Math.pow(lat2 - lat1, 2) + Math.pow(long2 - long1, 2));\n      let distanceInKm = distance * (Math.PI / 180) * EARTH_RADIUS_KM; //işletme konumu ile kullanıcının konumu arasındaki mesafe hesaplanır\n      return Number(distanceInKm.toFixed(2)); // Sonucu ondalıklı sayı  formatına döner örn: 1.149875646 değerini  1.15  km olarak \n    }\n  }\n  _HomePage = HomePage;\n  _HomePage.ɵfac = function HomePage_Factory(t) {\n    return new (t || _HomePage)(i0.ɵɵdirectiveInject(i1.Geolocation), i0.ɵɵdirectiveInject(i2.RestaurantService));\n  };\n  _HomePage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: _HomePage,\n    selectors: [[\"app-home\"]],\n    decls: 20,\n    vars: 2,\n    consts: [[3, \"translucent\"], [2, \"background-color\", \"white\"], [\"slot\", \"start\"], [\"src\", \"assets/icon/menu.png\"], [\"slot\", \"end\"], [\"src\", \"assets/icon/shopping.png\"], [\"src\", \"assets/icon/pastOrders.png\"], [\"show-clear-button\", \"always\", \"clear-icon\", \"options-outline\", \"placeholder\", \"Mekan ara\", 2, \"margin-top\", \"20px\", \"margin-bottom\", \"20px\", \"background-color\", \"white\", 3, \"ionInput\"], [1, \"results-title\"], [4, \"ngFor\", \"ngForOf\"], [\"threshold\", \"100px\", 3, \"ionInfinite\"], [\"loadingSpinner\", \"bubbles\", \"loadingText\", \"Loading more data...\"], [1, \"image-container\"], [4, \"ngIf\"], [2, \"font-size\", \"18px\"], [1, \"info-container\"], [1, \"info-item\"], [\"name\", \"basket\"], [\"name\", \"location-outline\"], [3, \"ngClass\"], [1, \"restaurant-image\", 3, \"src\"], [\"color\", \"danger\", 1, \"rating-badge\"], [\"src\", \"assets/icon/star.png\"]],\n    template: function HomePage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\", 0)(1, \"ion-toolbar\", 1)(2, \"ion-buttons\", 2)(3, \"ion-button\");\n        i0.ɵɵelement(4, \"img\", 3);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(5, \"ion-buttons\", 4)(6, \"ion-button\");\n        i0.ɵɵelement(7, \"img\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"ion-button\");\n        i0.ɵɵelement(9, \"img\", 6);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(10, \"ion-title\");\n        i0.ɵɵtext(11, \"Ana Sayfa\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(12, \"ion-content\")(13, \"ion-searchbar\", 7);\n        i0.ɵɵlistener(\"ionInput\", function HomePage_Template_ion_searchbar_ionInput_13_listener($event) {\n          return ctx.filterRestaurants($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"p\", 8)(15, \"b\");\n        i0.ɵɵtext(16, \"Sonu\\u00E7lar\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(17, HomePage_ion_card_17_Template, 25, 12, \"ion-card\", 9);\n        i0.ɵɵelementStart(18, \"ion-infinite-scroll\", 10);\n        i0.ɵɵlistener(\"ionInfinite\", function HomePage_Template_ion_infinite_scroll_ionInfinite_18_listener($event) {\n          return ctx.loadMore($event);\n        });\n        i0.ɵɵelement(19, \"ion-infinite-scroll-content\", 11);\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"translucent\", true);\n        i0.ɵɵadvance(17);\n        i0.ɵɵproperty(\"ngForOf\", ctx.restaurants);\n      }\n    },\n    dependencies: [i3.NgClass, i3.NgForOf, i3.NgIf, i4.IonBadge, i4.IonButton, i4.IonButtons, i4.IonCard, i4.IonCardContent, i4.IonCardTitle, i4.IonContent, i4.IonHeader, i4.IonIcon, i4.IonInfiniteScroll, i4.IonInfiniteScrollContent, i4.IonSearchbar, i4.IonTitle, i4.IonToolbar, i4.TextValueAccessor],\n    styles: [\"[_nghost-%COMP%]{font-family:Montserrat,sans-serif}.results-title[_ngcontent-%COMP%]{margin:0;padding-left:16px;font-size:14px}.image-container[_ngcontent-%COMP%]{position:relative;width:100%}.restaurant-image[_ngcontent-%COMP%]{width:100%;height:150px;object-fit:cover}.rating-badge[_ngcontent-%COMP%]{position:absolute;top:8px;left:8px;z-index:10;font-size:12px}.info-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}.info-item[_ngcontent-%COMP%]{flex:1 1 calc(50% - 8px);display:flex;align-items:center;font-size:12px;gap:4px}.open[_ngcontent-%COMP%]{color:green}.closed[_ngcontent-%COMP%]{color:red}\"]\n  });\n  return HomePage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}